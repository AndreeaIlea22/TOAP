{% extends "layouts/base.html" %}

{% set form_id = "new_form" %}
{% set form_action = url_for("apply.public_application") %}
{% set formulaic_after = url_for("apply.application_thanks") %}
{% if obj %}
    {% set form_action = url_for("apply.public_application", draft_id=obj.id) %}
    {# {% set form_id = url_for("apply.public_application", draft_id=obj.id) %} #}
{% endif %}

{% set js_validation = True %}
{% set auto_save = config.get("PUBLIC_FORM_AUTOSAVE", 0) %}
{% set TAB1 = {"title": "Open access compliance", "fieldsets": ["basic_compliance"]} %}
{% set TAB2 = {"title": "About the Journal", "fieldsets": ["about_the_journal", "publisher", "society_or_institution"]} %}
{% set TAB3 = {"title": "Copyright & licensing", "fieldsets": ["licensing", "embedded_licensing", "copyright"]} %}
{% set TAB4 = {"title": "Editorial", "fieldsets": ["peer_review", "plagiarism", "editorial"]} %}
{% set TAB5 = {"title": "Business model", "fieldsets": ["apc", "apc_waivers", "other_fees"]} %}
{% set TAB6 = {"title": "Best practice", "fieldsets": ["archiving_policy", "deposit_policy", "unique_identifiers"]} %}
{% set FORM = [TAB1, TAB2, TAB3, TAB4, TAB5, TAB6] %}


{% block content scoped %}
<body id="apply">
    <main class="container">
        <div class="row">
            <div class="col-md-8">
                <section class="page-content">
                    <form id="{{ form_id }}"
                      context = "{{ formulaic_context.name }}"
                      class="application_form"
                      novalidate
                      action="{{ form_action }}"
                      method="post"
                      data-formulaic-after="{{ formulaic_after }}">
                    <div class="tab form-section">
                        {% include "application_form/01-oa-compliance/index.html" %}
                    </div>
                    <div class="tab form-section">
                        {% include "application_form/02-about/index.html" %}
                    </div>
                    <div class="tab form-section">
                        {% include "application_form/03-copyright-licensing/index.html" %}
                    </div>
                    <div class="tab form-section">
                        {% include "application_form/04-editorial/index.html" %}
                    </div>
                    <div class="tab form-section">
                        {% include "application_form/05-business-model/index.html" %}
                    </div>
                    <div class="tab form-section">
                        {% include "application_form/06-best-practice/index.html" %}
                    </div>
                        <div class="tab form-section">
                        {% include "application_form/07-review/index.html" %}
                    </div>
                    <p class="cannot-submit" id="cannot_save_draft" style="display: none"><i>You cannot save the draft because your application contains some invalid fields. You do not have to provide all required answers but all provided information must have valid format. Please review your answers and try again.</i></p>
                    <p class="cannot-submit" id="cannot-submit-invalid-fields" style="display: none"><i>You cannot submit the application because it contains some invalid fields. Please review your answers and try again.</i></p>
                    {% include "application_form/_buttons.html" %}

                    {% if obj %}
                        <input type="hidden" name="id" value="{{ obj.id }}">
                    {% endif %}
                </form>
                </section>
            </div>

            <div class="col-md-4">
                <div >
                    {% include "application_form/pagination_menu.html" %}
                </div>
                <div class="row">
                    {% include "application_form/aside_menu.html" %}
                </div>
            </div>
        </div>
    </main>
 </body>
{% endblock %}

{% block extra_js_bottom scoped %}
    {% include "application_form/js/_form_js.html" %}
{% endblock %}
