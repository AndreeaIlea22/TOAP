{% extends "base.html" %}

{% block content %}

{%
    set TYN = {
        True : "Yes",
        False : "No",
    }
%}

{% set bibjson = article.bibjson() %}
{% set jbib = journal.bibjson() %}
{% set jtitle, cite = bibjson.vancouver_citation() %}
{% set issns = bibjson.issns() %}
{% set doi = bibjson.get_one_identifier("doi") %}

<div class="row-fluid">
    <div class="span12">
        <h1>{{bibjson.title}}</h1>

        <p>
        {# citation #}
        {% if issns|length > 0 %}
            <a href="{{url_for('doaj.toc', identifier=issns[0])}}">{{jtitle}}</a>. {{cite}}
        {% else %}
            {{jtitle}}. {{cite}}
        {% endif %}

        {# doi #}
        {% if doi %}
            DOI {{ doi | doi_url | safe}}
        {% endif %}

        </p>
    </div>

</div>

<div class="row-fluid" style="margin-bottom: 30px; margin-top: 30px">
    <div class="span1">&nbsp;</div>
    <div class="span5">
        <div class="box with-borders" style="min-height: 140px">
            {% if jbib.get_single_url("homepage") %}
                <p><a href="{{jbib.get_single_url('homepage')}}">Journal Homepage</a></p>
            {% endif %}

            <p><strong>Journal Title</strong>: {{ jbib.title }}</p>

            {# this next bit has to be all on one line so that the spacing is correct #}
            {% if jbib.issns()|length > 0 %}
            <p>
            <strong>ISSN</strong>:
            {% for identifier in jbib.get_identifiers(idtype='pissn') %}{{identifier}} (Print){% endfor %}{% for identifier in jbib.get_identifiers(idtype='eissn') %}{% if jbib.get_identifiers(idtype='pissn') %};&nbsp;{% endif %}{{identifier}} (Online){% endfor %}
            </p>
            {% endif %}

            {% if jbib.publisher %}
                <p><strong>Publisher</strong>:&nbsp;{{jbib.publisher}}</p>
            {% endif %}
            {% if jbib.institution %}
                <p><strong>Society/Institution</strong>:&nbsp;{{jbib.institution}}</p>
            {% endif %}

        </div>
    </div>

    <div class="span5">
        <div class="box with-borders" style="min-height: 140px">

            {% for path in bibjson.lcc_paths() %}
                {% if loop.index0 == 0 %}<p><strong>LCC Subject Category</strong>: {% endif %}
                {% if loop.index0 > 0 %} | {% endif %}
                {{ path }}
                {% if loop.last %}</p>{% endif %}
            {% endfor %}


            {% if jbib.country %}
                <p><strong>Country of publisher</strong>:&nbsp;{{jbib.country_name()}}</p>
            {% endif %}

            {% if jbib.language %}
                <p><strong>Language of fulltext</strong>:&nbsp;{{jbib.language_name()|join(", ")}}</p>
            {% endif %}

            {% if jbib.format|length > 0 %}
                <p><strong>Full-text formats available</strong>: {{jbib.format|join(", ")}}</p>
            {% endif %}
        </div>
    </div>
</div>

<div class="row-fluid" style="margin-top: 30px">
    <div class="span1">&nbsp;</div>
    <div class="span5">
        <div class="box slim">
            <p><strong>AUTHORS</strong></p>

            <p>
                {% for author in bibjson.author %}
                <em>{{author.name}}
                    {% if author.affiliation %} ({{author.affiliation}})
                    {% endif %}
                </em><br>
                {% endfor %}
            </p>

        </div>
    </div>

    <div class="span5">
        <div class="box slim">
            <p><strong>EDITORIAL INFORMATION</strong></p>

            {% if jbib.editorial_review %}
                {% if jbib.editorial_review.get("process") or jbib.editorial_review.get("url") %}
                    <p>
                    {% if jbib.editorial_review.get("url") %}
                        <a href="{{jbib.editorial_review.get('url')}}">{{jbib.editorial_review.get("process", "Review process unknown")}}</a>
                    {% else %}
                        {{jbib.editorial_review.get("process", "Review process unknown")}}
                    {% endif %}
                    </p>
                {% endif %}
            {% endif %}

            {% if jbib.get_single_url("editorial_board") %}
                <p><a href="{{jbib.get_single_url('editorial_board')}}">Editorial Board</a></p>
            {% endif %}

            {% if jbib.get_single_url("author_instructions") %}
                <p><a href="{{jbib.get_single_url('author_instructions')}}">Instructions for authors</a></p>
            {% endif %}

            {% if jbib.publication_time %}
                <p>Time From Submission to Publication: {{jbib.publication_time}} weeks</p>
            {% endif %}

        </div>
    </div>

</div>

<div class="row-fluid" style="margin-top: 30px">
    <div class="span1">&nbsp;</div>
    <div class="span10">
        <div style="padding: 0.5em">

        <p>
            <strong>
                Abstract
                {% for url in bibjson.get_urls("fulltext") %}
                    | <a href="{{url}}">Full Text</a>
                {% endfor %}
            </strong>
        </p>
        <p>{{bibjson.abstract}}</p>

        </div>

    </div>
</div>

{% endblock %}
