{% extends "admin/admin_base.html" %}

{% block admin_content %}

{# NOTE: requires suggest.js to be enabled (see _js_includes.html) #}

<div class="row-fluid" style="margin-bottom: 20px">
    <div class="span12">
        <h1>Suggested Journal: {{suggestion.bibjson().title}}</h1>
    </div>
</div>

<div class="row-fluid">

    <div class="span7">
        
        <div class="row-fluid"><div class="span3"><strong>title</strong></div><div class="span9">{{suggestion.bibjson().title}}</div></div>
        
        <div class="row-fluid">
            <div class="span3"><strong>alternative title</strong></div>
            <div class="span9">{% if suggestion.bibjson().alternative_title %}{{suggestion.bibjson().alternative_title}}{% endif %}</div>
        </div>
        
        <!-- issns -->
        {% for identifier in suggestion.bibjson().get_identifiers() %}
            <div class="row-fluid">
                <div class="span3"><strong>{% if identifier.type %}{{identifier.type}}{% else %}identifier{% endif %}</strong></div>
                <div class="span9">{{identifier.id}}</div>
            </div>
        {% endfor %}
        
        <!-- urls -->
        {% for link in suggestion.bibjson().get_urls() %}
            <div class="row-fluid">
                <div class="span3"><strong>{% if link.type %}{{link.type}}{% else %}url{% endif %}</strong></div>
                <div class="span9">
                    {% if link.url %}
                        {% if link.url.startswith("http") %}
                            <a href="{{link.url}}">{{link.url}}</a>
                        {% else %}
                            {{link.url}}
                        {% endif %}
                    {% endif %}
                </div>
            </div>
        {% endfor %}
        
        <div class="row-fluid">
            <div class="span3"><strong>author pays?</strong></div>
            <div class="span9">{% if suggestion.bibjson().author_pays %}{{suggestion.bibjson().author_pays}}{% endif %}</div>
        </div>
        
        <div class="row-fluid">
            <div class="span3"><strong>author pays url</strong></div>
            <div class="span9">
                {% if suggestion.bibjson().author_pays_url %}
                    <a href="{{suggestion.bibjson().author_pays_url}}" target="_blank">{{suggestion.bibjson().author_pays_url}}</a>
                {% endif %}
            </div>
        </div>
        
        <div class="row-fluid">
            <div class="span3"><strong>country</strong></div>
            <div class="span9">{% if suggestion.bibjson().country %}{{suggestion.bibjson().country}}{% endif %}</div>
        </div>
        
        <div class="row-fluid">
            <div class="span3"><strong>publisher</strong></div>
            <div class="span9">{% if suggestion.bibjson().publisher %}{{suggestion.bibjson().publisher}}{% endif %}</div>
        </div>
        
        <div class="row-fluid">
            <div class="span3"><strong>provider</strong></div>
            <div class="span9">{% if suggestion.bibjson().provider %}{{suggestion.bibjson().provider}}{% endif %}</div>
        </div>
        
        <div class="row-fluid">
            <div class="span3"><strong>language(s)</strong></div>
            <div class="span9">{%if suggestion.bibjson().language %}{{suggestion.bibjson().language|join(", ")}}{% endif %}</div>
        </div>
        
        <div class="row-fluid">
            <div class="span3"><strong>licence</strong></div>
            <div class="span9">
                {% if suggestion.bibjson().get_license() %}
                    {{suggestion.bibjson().get_license().title}}
                {% endif %}
            </div>
        </div>
        
        <div class="row-fluid">
            <div class="span3"><strong>OA Start</strong></div>
            <div class="span9">
                {% if suggestion.bibjson().oa_start %}
                    {% if suggestion.bibjson().oa_start.year %}year: {{suggestion.bibjson().oa_start.year}}&nbsp;{% endif %}
                    {% if suggestion.bibjson().oa_start.volume %}volume: {{suggestion.bibjson().oa_start.volume}}&nbsp;{% endif %}
                    {% if suggestion.bibjson().oa_start.number %}number: {{suggestion.bibjson().oa_start.number}}&nbsp;{% endif %}
                {% endif %}
            </div>
        </div>
        
        <div class="row-fluid">
            <div class="span3"><strong>OA End</strong></div>
            <div class="span9">
                {% if suggestion.bibjson().oa_end %}
                    {% if suggestion.bibjson().oa_end.year %}year: {{suggestion.bibjson().oa_end.year}}&nbsp;{% endif %}
                    {% if suggestion.bibjson().oa_end.volume %}volume: {{suggestion.bibjson().oa_end.volume}}&nbsp;{% endif %}
                    {% if suggestion.bibjson().oa_end.number %}number: {{suggestion.bibjson().oa_end.number}}&nbsp;{% endif %}
                {% endif %}
            </div>
        </div>
        
        <div class="row-fluid">
            <div class="span3"><strong>contact</strong></div>
            <div class="span9">
                {% for contact in suggestion.contacts() %}
                    {% if contact.name %}
                        {{contact.name}}
                    {% endif %}
                    {% if contact.email %}
                        (<a href="mailto:{{contact.email}}">{{contact.email}}</a>)
                    {% endif %}
                {% endfor %}
            </div>
        </div>
        
    </div>
    
    <div class="span5">
        <div class="row-fluid">
            <div class="span12">
                <div class="well">
                    <strong>current status</strong><br>
                    <input type="hidden" name="suggestion_id" value="{{suggestion.id}}">
                    <input type="hidden" name="current_status" value="{{suggestion.application_status}}">
                    <select name="application_status">
                        <option value="pending"{% if suggestion.application_status == "pending"%} selected="selected"{% endif %}>pending</option>
                        <option value="waiting for answer"{% if suggestion.application_status == "waiting for answer"%} selected="selected"{% endif %}>waiting for answer</option>
                        <option value="answer received"{% if suggestion.application_status == "answer received"%} selected="selected"{% endif %}>answer received</option>
                        <option value="rejected"{% if suggestion.application_status == "rejected"%} selected="selected"{% endif %}>rejected</option>
                    </select>
                    <button id='submit_status' class="btn" disabled="disabled">Update Status</button>
                    
                </div>
            </div>
        </div>
        
        <div class="row-fluid">
            <div class="span12">
                <div class="well">
                
                    <div class="row-fluid" style="margin-bottom: 5px;">
                        <div class="span12">
                            <strong>suggested by</strong><br>
                            {% if suggestion.suggester %}
                                {% if suggestion.suggester.name %}
                                    {{suggestion.suggester.name}}
                                {% endif %}
                                {% if suggestion.suggester.email %}
                                    (<a href="mailto:{{suggestion.suggester.email}}">{{suggestion.suggester.email}}</a>)
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="row-fluid" style="margin-bottom: 5px;">
                        <div class="span12">
                            <strong>suggested on</strong><br>
                            {% if suggestion.suggested_on %}{{suggestion.suggested_on}}{% endif %}
                        </div>
                    </div>
                    
                    <div class="row-fluid" style="margin-bottom: 5px;">
                        <div class="span12">
                            <strong>suggester is owner?</strong><br>
                            {% if suggestion.suggested_by_owner is defined %}{{suggestion.suggested_by_owner}}{% endif %}
                        </div>
                    </div>
                    
                    <div class="row-fluid">
                        <div class="span12">
                            <strong>description</strong><br>
                            {% if suggestion.description %}{{suggestion.description}}{% else %}no description available{% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
    </div>

</div>

<div class="row-fluid" style="border-top: 1px dashed #cccccc; margin-top: 40px; padding-top: 40px">
    <div class="span12">
        <h3>Notes</h3>
        {% for note in suggestion.notes() %}
            <strong>{{note.date}}</strong>
            <p>{{note.note}}</p>
        {% endfor %}
        {% if suggestion.notes()|length == 0 %}
            <em>no notes currently attached to this suggestion</em>
        {% endif %}
        
        <h3>Correspondence</h3>
        {% for corr in suggestion.correspondence() %}
            <strong>{{corr.date}}</strong>
            <p>{{corr.note}}</p>
        {% endfor %}
        {% if suggestion.correspondence()|length == 0 %}
            <em>no correspondence currently attached to this suggestion</em>
        {% endif %}
    </div>
</div>

{% endblock %}

