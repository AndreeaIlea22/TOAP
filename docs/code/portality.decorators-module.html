<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>portality.decorators</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="portality-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="https://github.com/DOAJ/doaj">DOAJ</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="portality-module.html">Package&nbsp;portality</a> ::
        Module&nbsp;decorators
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="portality.decorators-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module decorators</h1><p class="nomargin-top"><span class="codelink"><a href="portality.decorators-pysrc.html">source&nbsp;code</a></span></p>
<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="swag"></a><span class="summary-sig-name">swag</span>(<span class="summary-sig-arg">swag_summary</span>,
        <span class="summary-sig-arg">swag_spec</span>)</span><br />
      Decorator for API functions, adding swagger info to the swagger spec.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="portality.decorators-pysrc.html#swag">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="api_key_required"></a><span class="summary-sig-name">api_key_required</span>(<span class="summary-sig-arg">fn</span>)</span><br />
      Decorator for API functions, requiring a valid key to find a user</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="portality.decorators-pysrc.html#api_key_required">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="api_key_optional"></a><span class="summary-sig-name">api_key_optional</span>(<span class="summary-sig-arg">fn</span>)</span><br />
      Decorator for API functions, requiring a valid key to find a user if a key is provided. OK if none provided.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="portality.decorators-pysrc.html#api_key_optional">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="ssl_required"></a><span class="summary-sig-name">ssl_required</span>(<span class="summary-sig-arg">fn</span>)</span><br />
      Decorator for when a view f() should be served only over SSL</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="portality.decorators-pysrc.html#ssl_required">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="restrict_to_role"></a><span class="summary-sig-name">restrict_to_role</span>(<span class="summary-sig-arg">role</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="portality.decorators-pysrc.html#restrict_to_role">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="write_required"></a><span class="summary-sig-name">write_required</span>(<span class="summary-sig-arg">script</span>=<span class="summary-sig-default">False</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="portality.decorators-pysrc.html#write_required">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="portality.decorators-module.html#track_analytics" class="summary-sig-name">track_analytics</a>(<span class="summary-sig-arg">event_category</span>,
        <span class="summary-sig-arg">event_action</span>,
        <span class="summary-sig-arg">event_label</span>=<span class="summary-sig-default">''</span>,
        <span class="summary-sig-arg">event_value</span>=<span class="summary-sig-default">0</span>,
        <span class="summary-sig-arg">record_value_of_which_arg</span>=<span class="summary-sig-default">''</span>)</span><br />
      Decorator for Flask view functions, sending event data to Google
Analytics. (supposedly supporting other analytics providers as well,
check <a class="rst-reference external" href="https://github.com/analytics-pros/universal-analytics-python" target="_top">https://github.com/analytics-pros/universal-analytics-python</a> )</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="portality.decorators-pysrc.html#track_analytics">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="track_analytics"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">track_analytics</span>(<span class="sig-arg">event_category</span>,
        <span class="sig-arg">event_action</span>,
        <span class="sig-arg">event_label</span>=<span class="sig-default">''</span>,
        <span class="sig-arg">event_value</span>=<span class="sig-default">0</span>,
        <span class="sig-arg">record_value_of_which_arg</span>=<span class="sig-default">''</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="portality.decorators-pysrc.html#track_analytics">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Decorator for Flask view functions, sending event data to Google
Analytics. (supposedly supporting other analytics providers as well,
check <a class="rst-reference external" href="https://github.com/analytics-pros/universal-analytics-python" target="_top">https://github.com/analytics-pros/universal-analytics-python</a> )</p>
<p>See <a class="rst-reference external" href="https://support.google.com/analytics/answer/1033068?hl=en" target="_top">https://support.google.com/analytics/answer/1033068?hl=en</a> for
guidance on how to use the various event properties this decorator
takes.</p>
<p>One thing to note is that event_value must be an integer. We
don't really use that, it's for things like &quot;total downloads&quot; or
&quot;number of times video played&quot;.</p>
<p>The others are strings and can be anything we like. They must
take into account what previous strings we've sent so that events
can be aggregated correctly. Changing the strings you use for
categories, actions and labels to describe the same event will
split your analytics reports into two: before and after the
change of the event strings you use.</p>
<p>the view function takes. During tracking, the value of that
argument will be extracted and sent as the Event Label to the
analytics servers. NOTE! If you pass both event_label and
record_value_of_which_arg to this decorator, event_label will be
ignored and overwritten by the action that
record_value_of_which_arg causes.</p>
<dl class="rst-docutils">
<dt>For example:</dt>
<dd><dl class="rst-first rst-last rst-docutils">
<dt>&#64;track_analytics('API Hit', 'Search applications',</dt>
<dd>record_value_of_which_arg='search_query')</dd>
<dt>def search_applications(search_query):</dt>
<dd># ...</dd>
</dl>
</dd>
</dl>
<p>Then we get a hit, with search_query being set to 'computer shadows'.
This will result in an event with category &quot;API Hit&quot;, action &quot;Search
applications&quot; and label &quot;computer shadows&quot;.</p>
<dl class="rst-docutils">
<dt>A different example:</dt>
<dd><dl class="rst-first rst-last rst-docutils">
<dt>&#64;track_analytics('API Hit', 'Retrieve application',</dt>
<dd>record_value_of_which_arg='application_id')</dd>
<dt>def retrieve_application(application_id):</dt>
<dd># ...</dd>
</dl>
</dd>
</dl>
<p>Then we get a hit asking for application with id '12345'.
This will result in an event with category &quot;API Hit&quot;, action &quot;Retrieve
application&quot; and label &quot;12345&quot;.</p>
<dl class="rst-docutils">
<dt>Clashing arguments:</dt>
<dd><dl class="rst-first rst-last rst-docutils">
<dt>&#64;track_analytics('API Hit', 'Retrieve application',</dt>
<dd>event_label='Special interest action',
record_value_of_which_arg='application_id')</dd>
<dt>def retrieve_application(application_id):</dt>
<dd># ...</dd>
</dl>
</dd>
</dl>
<p>Then we get a hit asking for application with id '12345' again.
This will result in an event with category &quot;API Hit&quot;, action &quot;Retrieve
application&quot; and label &quot;12345&quot;. I.e. the event_label passed in will
be ignored, because we also passed in record_value_of_which_arg which
overrides the event label sent to the analytics servers.</p>
<p>On testing: this has been tested manually on DOAJ with Google
Analytics by &#64;emanuil-tolev.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>record_value_of_which_arg</code></strong> - The name of one argument that</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="portality-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="https://github.com/DOAJ/doaj">DOAJ</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Thu Jan 25 09:40:57 2018
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
