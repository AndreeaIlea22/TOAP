{% if page.fragment == false %}
<!DOCTYPE html>
<html lang="en">

  {% include head.html %}

  <body>
    {% include header.html %}
{% endif %}

    <main class="container">
      <section class="page-content">
        {% if page.section %}<p class="label">{{ page.section }}</p>{% endif %}
        <h1>{{ page.title }}</h1>

        {% assign min = 0 %}
        {% assign max = site.data.promo.size %}
        {% assign diff = max | minus: min %}
        {% assign random = "now" | date: "%N" | modulo: diff | plus: min %}

        <p class="alert">
          <span data-feather="alert-circle"></span> <em>Search tip:</em> {{ site.data.search-tips[random].text }}
        </p>

        <div class="input-group">
          <label for="keywords" class="sr-only">Search by keywords:</label>
          <input type="text" name="keywords" id="keywords" required>

          <label for="fields" class="sr-only">In the field:</label>
          <select name="fields" id="fields">
            <option value="all">In all fields</option>
            <option value="title">Title</option>
            <option value="abstract">Abstract</option>
            <option value="subject">Subject</option>
            <option value="subject">Author</option>
          </select>

          <button type="submit">
            <span data-feather="search"></span><span class="sr-only"> Search</span>
          </button>
        </div>

        <div class="row">

          {% if page.name == 'journals.md' %}
          <div class="col-md-3">
            <aside class="filters">
              <h2 class="filters__heading">Refine search results</h2>
              <ul class="unstyled-list">
                <li class="filter">
                  <h3 class="filter__heading" type="button" data-toggle="collapse" data-target="#filter-subjects" aria-expanded="false">
                    Subjects
                    <span data-feather="chevron-down"></span>
                  </h3>
                  <div id="filter-subjects" class="collapse" aria-expanded="false">
                    <ul class="unstyled-list filter__choices">
                      {% for i in site.data.search-filters.subjects limit:10 %}
                      <li>
                        <input id="{{ i.name }}" type="checkbox" name="{{ i.name }}"/>
                        <label for="{{ i.name }}" class="filter__label">{{ i.name }} ({{ i.total }})</label>
                      </li>
                      {% endfor %}
                    </ul>
                    <!-- <span type="button" data-toggle="collapse" data-target="#filter-subjects-more" aria-expanded="false">
                      More <span data-feather="plus"></span>
                    </span>
                    <ul id="#filter-subjects-more" class="collapse" aria-expanded="false">
                      {% for i in site.data.search-filters.subjects offset:10 %}
                      <li>
                        <input id="{{ i.name }}" type="checkbox" name="{{ i.name }}"/>
                        <label for="{{ i.name }}" class="filter__label">{{ i.name }} ({{ i.total }})</label>
                      </li>
                      {% endfor %}
                    </ul> -->
                  </div>
                </li>

                <li class="filter">
                  <h3 class="filter__heading" type="button" data-toggle="collapse" data-target="#filter-apc" aria-expanded="false">
                    APCs
                    <span data-feather="chevron-down"></span>
                  </h3>
                  <ul class="unstyled-list collapse filter__choices" id="filter-apc" aria-expanded="false">
                    {% for i in site.data.search-filters.apc %}
                    <li>
                      <input id="{{ i.name }}" type="checkbox" name="{{ i.name }}"/>
                      <label for="{{ i.name }}" class="filter__label">{{ i.name }} ({{ i.total }})</label>
                    </li>
                    {% endfor %}
                  </ul>
                </li>
              </ul>
            </aside>
          </div>

          <div class="col-md-9">
            <h2>Showing 14,576 indexed journals</h2>
            <div class="row">
              <div class="col-xs-6">
                <label for="sort-by">Sort by</label>
                <select name="sort-by" id="sort-by">
                  <option value="">Added to DOAJ (newest first)</option>
                  <option value="">Added to DOAJ (oldest first)</option>
                  <option value="">Last updated (most recent first)</option>
                  <option value="">Last updated (less recent first)</option>
                  <option value="">Title (A-Z)</option>
                  <option value="">Title (Z-A)</option>
                  <option value="">Relevance</option>
                </select>
              </div>
              <div class="col-xs-6">
                <label for="sort-fields">Results per page</label>
                <select name="fields" id="fields">
                  <option value="all">50</option>
                  <option value="all">100</option>
                  <option value="all">200</option>
                </select>
              </div>
            </div>
            <ol class="search-results">
              {% for i in site.data.journals %}
              <li class="search-results__record">
                <article class="row">
                  <div class="col-xs-8">
                    <p class="label">
                      <small>{{ i.lcc }}</small>
                    </p>
                    <h3 class="search-results__heading">
                      {{ i.title }}
                      {% if i.paral_title %}<br/><span class="search-results__secondary-heading">{{ i.paral_title }}</span>{% endif %}
                    </h3>
                    <ul class="unstyled-list search-results__body">
                      <li>
                        Publishes <strong>{{ i.formats }}</strong> articles in <strong>{{ i.lang }}</strong>
                      </li>
                      <li>
                        Published {% if i.institution %}by <em>{{ i.institution }}</em>{% endif %} in <strong>{{ i.country }}</strong>
                      </li>
                      <li>
                        <small>{% if i.apc %}{{ i.apc }} processing fee{% else %}No charges{% endif %};
                        {{ i.processing_time }} weeks to publication</small>
                      </li>
                    </ul>
                  </div>
                  <aside class="col-xs-4">
                    <ul class="unstyled-list">
                      <li>
                        <a href="{{ i.url }}" target="_blank">Website</a>
                      </li>
                      <li>
                        <a href="{{ i.license_url }}" target="_blank">{{ i.license }}</a>
                      </li>
                      {% if i.articles %}
                      <li>
                        {{ i.articles }} articles dating back to {{ i.oa_since }}
                      </li>
                      {% endif %}
                      <li>
                        {% if i.updated %}Last updated on {{ i.updated }}
                        {% else %}Added on {{ i.added }}{% endif %}
                      </li>
                    </ul>
                  </aside>
                </article>
              </li>
              {% endfor %}
            </ol>
          </div>
          {% endif %}

          {% if page.name == 'articles.md' %}
          <div class="col-md-10">
            <h2>Showing 4,873,612 indexed articles</h2>
            <ol class="search-results">
              {% for i in site.data.articles %}
              <li class="search-results__record">
                <article class="row">
                  <div class="col-xs-8">
                    <p class="label">
                      <small>{{ i.lcc }}</small>
                    </p>
                    <h3 class="search-results__heading">
                      {{ i.title }}
                      {% if i.paral_title %}<br/><span class="search-results__secondary-heading">{{ i.paral_title }}</span>{% endif %}
                    </h3>
                    <ul class="unstyled-list search-results__body">
                      <li>
                        Publishes <strong>{{ i.formats }}</strong> articles in <strong>{{ i.lang }}</strong>
                      </li>
                      <li>
                        Based {% if i.institution %}at <em>{{ i.institution }}</em>{% endif %} in <strong>{{ i.country }}</strong>
                      </li>
                      <li>
                        <small>{% if i.apc %}{{ i.apc }} processing fee{% else %}No charges{% endif %};
                        {{ i.processing_time }} weeks to publication</small>
                      </li>
                    </ul>
                  </div>
                  <aside class="col-xs-4">
                    <ul class="unstyled-list">
                      <li>
                        <a href="{{ i.url }}" target="_blank">Website</a>
                      </li>
                      <li>
                        <a href="{{ i.license_url }}" target="_blank">{{ i.license }}</a>
                      </li>
                      <li>
                        {% if i.articles %}{{ i.articles }} articles dating back to {{ i.oa_since }}
                        {% else %}<em>No articles indexed yet</em>{% endif %}
                      </li>
                      <li>
                        {% if i.updated %}Last updated on {{ i.updated }}
                        {% else %}Added on {{ i.added }}{% endif %}
                      </li>
                    </ul>
                  </aside>
                </article>
              </li>
              {% endfor %}
            </ol>
          </div>
          {% endif %}
        </div>
      </section>
    </main>

{% if page.fragment == false %}
    {% include footer.html %}
  </body>

</html>
{% endif %}
